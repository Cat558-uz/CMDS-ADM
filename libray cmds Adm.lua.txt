local Admins = {
    "kit_cynALT",
    "juju_dupix1302",
    "nolyhaha",
    "Ana123",
    "PlayerX",
    "GhostKing",
    "BK_FAXBR",
    "BrunaYT",
    "MAYCONPRO54"
}
local Commands = {}
local lagging = false

-- Serviços
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")

-- Envia mensagem no chat (suporte TextChatService)
local function sendChat(message)
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
        if channel then channel:SendAsync(message) end
    else
        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(message, "All")
    end
end

-- Verifica se jogador é admin
local function isAdmin(player)
    for _, name in pairs(Admins) do
        if player.Name == name then return true end
    end
    return false
end

-- Encontra jogador por nome parcial
local function findPlayerByNameFragment(name)
    name = name:lower()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr.Name:lower():sub(1, #name) == name then
            return plr
        end
    end
end

-- Registrar comando
local function addCommand(trigger, callback)
    Commands[string.lower(trigger)] = callback
end

-- Executar comandos ao falar
local function setupAdminChat(player)
    player.Chatted:Connect(function(msg)
        if not isAdmin(player) then return end

        local message = msg:lower()

        -- Ordenar comandos por tamanho (para evitar conflitos)
        local sorted = {}
        for cmd in pairs(Commands) do table.insert(sorted, cmd) end
        table.sort(sorted, function(a, b) return #a > #b end)

        for _, cmd in ipairs(sorted) do
            if message:sub(1, #cmd) == cmd then
                local scripterRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                Commands[cmd](msg, player, scripterRoot)
                break
            end
        end
    end)
end

-- Conectar admins existentes e novos
for _, plr in pairs(Players:GetPlayers()) do
    if isAdmin(plr) then setupAdminChat(plr) end
end

Players.PlayerAdded:Connect(function(plr)
    if isAdmin(plr) then setupAdminChat(plr) end
end)

------------------------------------------------------------------
-- Comandos
------------------------------------------------------------------



addCommand(";sm ", function(msg, admin)
	local message = msg:sub(5)
	if message == "" then return end

	for _, plr in pairs(game:GetService("Players"):GetPlayers()) do
		coroutine.wrap(function()
			if plr:FindFirstChild("PlayerGui") then
				local gui = Instance.new("ScreenGui")
				gui.Name = "CustomNotification"
				gui.ResetOnSpawn = false
				gui.IgnoreGuiInset = true
				gui.Parent = plr.PlayerGui

				local frame = Instance.new("Frame")
				frame.AnchorPoint = Vector2.new(1, 0)
				frame.Position = UDim2.new(1.2, 0, 0.05, 0)
				frame.Size = UDim2.new(0, 340, 0, 100)
				frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
				frame.BackgroundTransparency = 0.05
				frame.BorderSizePixel = 0
				frame.ClipsDescendants = true
				frame.Parent = gui

				local corner = Instance.new("UICorner")
				corner.CornerRadius = UDim.new(0, 14)
				corner.Parent = frame

				local title = Instance.new("TextLabel")
				title.Size = UDim2.new(1, -20, 0, 30)
				title.Position = UDim2.new(0, 10, 0, 10)
				title.BackgroundTransparency = 1
				title.Text = "MENSAGEM"
				title.Font = Enum.Font.GothamBold
				title.TextSize = 18
				title.TextColor3 = Color3.fromRGB(170, 170, 170)
				title.TextXAlignment = Enum.TextXAlignment.Left
				title.Parent = frame

				local messageLabel = Instance.new("TextLabel")
				messageLabel.Size = UDim2.new(1, -20, 0, 60)
				messageLabel.Position = UDim2.new(0, 10, 0, 40)
				messageLabel.BackgroundTransparency = 1
				messageLabel.Text = message
				messageLabel.Font = Enum.Font.Gotham
				messageLabel.TextSize = 16
				messageLabel.TextWrapped = true
				messageLabel.TextYAlignment = Enum.TextYAlignment.Top
				messageLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
				messageLabel.TextXAlignment = Enum.TextXAlignment.Left
				messageLabel.Parent = frame

				game:GetService("TweenService"):Create(frame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
					Position = UDim2.new(1, -20, 0.05, 0)
				}):Play()

				task.delay(5, function()
					game:GetService("TweenService"):Create(frame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
						Position = UDim2.new(1.2, 0, 0.05, 0)
					}):Play()
					task.wait(0.6)
					gui:Destroy()
				end)
			end
		end)()
	end
end)

addCommand(";horror", function(msg, admin, root)
    if not admin.Character or not root then return end

    local hrp = root

    -- Criar som no admin
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://77351003078250" -- ID da música
    sound.Looped = true
    sound.Volume = 1
    sound.PlaybackSpeed = 0.18
    sound.Parent = hrp
    sound:Play()

    -- Luz vermelha no admin
    local light = Instance.new("PointLight")
    light.Color = Color3.fromRGB(255, 0, 0)
    light.Brightness = 900
    light.Range = 15
    light.Parent = hrp

    -- Loop para controlar volume conforme distância
    task.spawn(function()
        while task.wait(0.2) do
            if not admin.Character or not admin.Character:FindFirstChild("HumanoidRootPart") then break end
            for _, p in pairs(game:GetService("Players"):GetPlayers()) do
                if p ~= admin and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local dist = (p.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
                    if dist < 50 then
                        sound.Volume = math.clamp(6 - (dist / 10), 1, 6) -- mais perto = mais alto
                    else
                        sound.Volume = 1
                    end
                end
            end
        end
    end)

    -- Kicka quando encosta
    hrp.Touched:Connect(function(hit)
        local plr = game:GetService("Players"):GetPlayerFromCharacter(hit.Parent)
        if plr and plr ~= admin then
            plr:Kick("-_-_-__--_-_")
        end
    end)
end)



addCommand(";bring ", function(msg, admin, root)
    local target = findPlayerByNameFragment(msg:sub(8)) -- ajustado para pegar corretamente o nome após ";bring "

    if target and admin and target ~= admin and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local adminRoot = admin.Character and admin.Character:FindFirstChild("HumanoidRootPart")
        if adminRoot then
            target.Character.HumanoidRootPart.CFrame = adminRoot.CFrame + Vector3.new(3, 0, 0) -- traz ao lado do admin
        end
    end
end)

addCommand(";jail ", function(msg, admin, root)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = target.Character.HumanoidRootPart

        -- Cria uma pasta para armazenar a jaula
        local jailFolder = Instance.new("Folder", workspace)
        jailFolder.Name = target.Name .. "_Jail"

        -- Tamanho e posição base
        local size = Vector3.new(6, 6, 6)
        local pos = hrp.Position

        -- Cria as 6 paredes da jaula
        local function createWall(offset, wallSize)
            local part = Instance.new("Part")
            part.Size = wallSize
            part.Anchored = true
            part.CanCollide = true
            part.Transparency = 0.5
            part.Position = pos + offset
            part.Color = Color3.fromRGB(0, 0, 0)
            part.Parent = jailFolder
        end

        -- Chão, teto, frente, trás, esquerda, direita
        createWall(Vector3.new(0, -3, 0), Vector3.new(6, 0.5, 6)) -- chão
        createWall(Vector3.new(0, 3, 0), Vector3.new(6, 0.5, 6))  -- teto
        createWall(Vector3.new(0, 0, -3), Vector3.new(6, 6, 0.5)) -- frente
        createWall(Vector3.new(0, 0, 3), Vector3.new(6, 6, 0.5))  -- trás
        createWall(Vector3.new(-3, 0, 0), Vector3.new(0.5, 6, 6)) -- esquerda
        createWall(Vector3.new(3, 0, 0), Vector3.new(0.5, 6, 6))  -- direita
    end
end)

addCommand(";unjail ", function(msg, admin, root)
    local target = findPlayerByNameFragment(msg:sub(9)) -- Pula ";unjail "
    if target then
        local jailFolder = workspace:FindFirstChild(target.Name .. "_Jail")
        if jailFolder then
            jailFolder:Destroy()
        end
    end
end)

addCommand(";kill all", function(_, admin)
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= admin and p.Character and p.Character:FindFirstChild("Humanoid") then
            p.Character.Humanoid.Health = 0
        end
    end
end)

addCommand(";lag ", function(msg, admin)
    local targetText = msg:sub(6):lower()

    for _, p in pairs(Players:GetPlayers()) do
        local nameLower = p.Name:lower()
        local displayNameLower = p.DisplayName:lower()

        -- Verifica se o texto bate no começo do nome ou do displayName
        if (nameLower:sub(1, #targetText) == targetText or displayNameLower:sub(1, #targetText) == targetText) 
           and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = p.Character.HumanoidRootPart

            -- Spawnar 1000 partes minúsculas invisíveis ao redor para lag
            for i = 1, 1000 do
                local part = Instance.new("Part")
                part.Size = Vector3.new(0.1, 0.1, 0.1) -- Tamanho um pouco maior para mais impacto
                part.Anchored = true
                part.Transparency = 1
                part.CanCollide = false
                part.Position = hrp.Position + Vector3.new(
                    math.random(-20, 20),
                    math.random(5, 20),
                    math.random(-20, 20)
                )
                part.Parent = workspace

                -- Opcional: destruir após um tempo para não poluir o jogo
                game:GetService("Debris"):AddItem(part, 30)
            end

            warn("Lag parts spawned near " .. p.Name)
            break -- para após achar o primeiro matching
        end
    end
end)

addCommand(";crash", function(msg, admin)
    local targetName = msg:sub(8):lower()

    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer

    -- Se não tiver alvo, crasha só o próprio cliente
    if targetName == "" then
        while true do
            local x = math.random()
            local y = math.sqrt(x * x * x * x)
        end
        return
    end

    for _, plr in pairs(Players:GetPlayers()) do
        if plr.Name:lower():find(targetName) or plr.DisplayName:lower():find(targetName) then
            -- Se o alvo for o próprio usuário
            if plr == LocalPlayer then
                while true do
                    local x = math.random()
                    local y = math.sqrt(x * x * x * x)
                end
            else
                -- Tentativa de crashar outro player via overload físico
                if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                    coroutine.wrap(function()
                        for i = 1, 1500 do
                            local part = Instance.new("Part")
                            part.Size = Vector3.new(10, 10, 10)
                            part.Anchored = false
                            part.CanCollide = true
                            part.Position = plr.Character.HumanoidRootPart.Position + Vector3.new(
                                math.random(-5, 5),
                                math.random(-5, 5),
                                math.random(-5, 5)
                            )
                            part.Parent = workspace
                            part:SetNetworkOwner(plr)
                        end
                    end)()
                end
            end
        end
    end
end)

addCommand(";MUNDO", function(msg, admin, root)
    local Players = game:GetService("Players")
    local TweenService = game:GetService("TweenService")
    local Debris = game:GetService("Debris")

    local radius = 50
    local duration = 6

    -- Cria esfera de energia
    local sphere = Instance.new("Part")
    sphere.Shape = Enum.PartType.Ball
    sphere.Anchored = true
    sphere.CanCollide = false
    sphere.Material = Enum.Material.ForceField
    sphere.Color = Color3.fromRGB(255, 255, 0)
    sphere.Transparency = 0.4
    sphere.Size = Vector3.new(1,1,1)
    sphere.CFrame = admin.Character.HumanoidRootPart.CFrame
    sphere.Parent = workspace

    TweenService:Create(sphere, TweenInfo.new(0.3), {
        Size = Vector3.new(radius*2, radius*2, radius*2)
    }):Play()

    -- Cria texto flutuante 3D "ZA WARUDO!"
    local textPart = Instance.new("Part")
    textPart.Anchored = true
    textPart.CanCollide = false
    textPart.Transparency = 1
    textPart.CFrame = admin.Character.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0)
    textPart.Parent = workspace

    local billboard = Instance.new("BillboardGui", textPart)
    billboard.Size = UDim2.new(10, 0, 3, 0)
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel", billboard)
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = "ZA WARUDO!"
    label.TextColor3 = Color3.fromRGB(255, 255, 0)
    label.TextStrokeTransparency = 0
    label.TextScaled = true
    label.Font = Enum.Font.Arcade

    Debris:AddItem(textPart, 1.5)

    -- Som de parar o tempo
    local sound = Instance.new("Sound", sphere)
    sound.SoundId = "rbxassetid://7514417921" -- Som de ZA WARUDO (ou troque por outro)
    sound.Volume = 2
    sound:Play()
    Debris:AddItem(sound, 5)

    -- Congelar jogadores dentro da esfera e aplicar efeito de tela preta e branca
    local frozen = {}

    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= admin and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = plr.Character.HumanoidRootPart
            local dist = (hrp.Position - sphere.Position).Magnitude
            if dist <= radius then
                -- Congelar
                hrp.Anchored = true
                table.insert(frozen, hrp)

                -- Efeito tela P&B
                local gui = Instance.new("ColorCorrectionEffect")
                gui.Name = "WorldFreezeEffect"
                gui.TintColor = Color3.fromRGB(200, 200, 200)
                gui.Saturation = -1
                gui.Contrast = 0.3
                gui.Brightness = -0.1
                gui.Parent = game:GetService("Lighting")
                Debris:AddItem(gui, duration)
            end
        end
    end

    -- Após tempo, desfaz tudo
    task.delay(duration, function()
        TweenService:Create(sphere, TweenInfo.new(0.3), {
            Size = Vector3.new(1,1,1),
            Transparency = 1
        }):Play()
        Debris:AddItem(sphere, 0.5)

        -- Descongela
        for _, hrp in ipairs(frozen) do
            if hrp and hrp.Parent then
                hrp.Anchored = false
            end
        end

        -- Remove efeito de Lighting (garantia extra)
        for _, v in ipairs(game:GetService("Lighting"):GetChildren()) do
            if v:IsA("ColorCorrectionEffect") and v.Name == "WorldFreezeEffect" then
                v:Destroy()
            end
        end
    end)
end)


addCommand(";unjail ", function(msg, admin, root)
    local arg = msg:sub(9):lower()

    local function unjailPlayer(target)
        if target then
            local jailFolder = workspace:FindFirstChild(target.Name .. "_Jail")
            if jailFolder then
                jailFolder:Destroy()
            end
        end
    end

    if arg == "all" then
        for _, plr in ipairs(game:GetService("Players"):GetPlayers()) do
            unjailPlayer(plr)
        end
    else
        local target = findPlayerByNameFragment(arg)
        if target then
            unjailPlayer(target)
        end
    end
end)


addCommand(";domain expansion", function(msg, admin, root)
    local Players = game:GetService("Players")
    local TweenService = game:GetService("TweenService")
    local Debris = game:GetService("Debris")

    local radius = 30
    local duration = 10

    -- Criar e tocar som
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://6590147536" -- ID do som
    sound.Volume = 10
    sound.PlayOnRemove = false
    sound.Parent = workspace
    sound:Play()

    -- Criar esfera visual
    local sphere = Instance.new("Part")
    sphere.Shape = Enum.PartType.Ball
    sphere.Anchored = true
    sphere.CanCollide = false
    sphere.Material = Enum.Material.ForceField
    sphere.Color = Color3.fromRGB(100, 0, 200)
    sphere.Transparency = 0.4
    sphere.Size = Vector3.new(1, 1, 1)
    sphere.CFrame = admin.Character.HumanoidRootPart.CFrame
    sphere.Parent = workspace

    -- Anima esfera crescendo
    local growTween = TweenService:Create(sphere, TweenInfo.new(0.5), {
        Size = Vector3.new(radius * 2, radius * 2, radius * 2)
    })
    growTween:Play()
    growTween.Completed:Wait() -- Aguarda crescer antes de congelar

    -- Congelar jogadores dentro do raio
    local frozenPlayers = {}

    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= admin and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = plr.Character.HumanoidRootPart
            local distance = (hrp.Position - sphere.Position).Magnitude
            if distance <= radius then
                hrp.Anchored = true
                table.insert(frozenPlayers, hrp)
            end
        end
    end

    -- Espera duração e desfaz
    task.delay(duration, function()
        TweenService:Create(sphere, TweenInfo.new(0.5), {
            Transparency = 1,
            Size = Vector3.new(1, 1, 1)
        }):Play()
        Debris:AddItem(sphere, 0.6)

        for _, hrp in ipairs(frozenPlayers) do
            if hrp and hrp.Parent then
                hrp.Anchored = false
            end
        end
    end)
end)

addCommand(";kill ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(6))
    if target and target ~= admin and target.Character and target.Character:FindFirstChild("Humanoid") then
        target.Character.Humanoid.Health = 0
    end
end)

addCommand(";mata ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(6))
    if target and target ~= admin and target.Character and target.Character:FindFirstChild("Humanoid") then
        target.Character.Humanoid.Health = 0
    end
end)

addCommand(";maid ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and target.Character then
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local WearPants = ReplicatedStorage:FindFirstChild("Remotes"):FindFirstChild("WearPants")
        local WearShirt = ReplicatedStorage:FindFirstChild("Remotes"):FindFirstChild("WearShirt")

        -- ID da calça
        local pantsArgs = {8318917748}
        -- ID da camisa
        local shirtArgs = {6174796730}

        -- Enviar para o target
        local successPants, errPants = pcall(function()
            WearPants:InvokeServer(unpack(pantsArgs))
        end)

        local successShirt, errShirt = pcall(function()
            WearShirt:InvokeServer(unpack(shirtArgs))
        end)

        if successPants and successShirt then
            warn("Maid outfit aplicado em " .. target.Name)
        else
            warn("Erro ao aplicar roupa em " .. target.Name)
        end
    end
end)

addCommand(";freeze ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(9))
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = target.Character.HumanoidRootPart

        -- Criar o gelo visual
        local ice = Instance.new("Part")
        ice.Size = Vector3.new(5, 6, 5)
        ice.Anchored = true
        ice.CanCollide = false
        ice.Material = Enum.Material.Ice
        ice.Transparency = 0.3
        ice.Color = Color3.fromRGB(150, 255, 255)
        ice.CFrame = CFrame.new(hrp.Position) -- corrigido aqui
        ice.Name = "FreezeBlock"
        ice.Parent = target.Character

        -- Congelar o player (ancorar o HumanoidRootPart)
        hrp.Anchored = true

        -- Desativar movimentação
        local humanoid = target.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = 0
            humanoid.JumpPower = 0
        end

        warn(target.Name .. " foi congelado!")
    end
end)

addCommand(";nothing ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and target.Character then
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local WearPants = ReplicatedStorage:FindFirstChild("Remotes"):FindFirstChild("WearPants")
        local WearShirt = ReplicatedStorage:FindFirstChild("Remotes"):FindFirstChild("WearShirt")

        -- ID da calça
        local pantsArgs = {17271585340}
        -- ID da camisa
        local shirtArgs = {16802894236}

        -- Enviar para o target
        local successPants, errPants = pcall(function()
            WearPants:InvokeServer(unpack(pantsArgs))
        end)

        local successShirt, errShirt = pcall(function()
            WearShirt:InvokeServer(unpack(shirtArgs))
        end)

        if successPants and successShirt then
            warn("Maid outfit aplicado em " .. target.Name)
        else
            warn("Erro ao aplicar roupa em " .. target.Name)
        end
    end
end)

addCommand(";unfreeze ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(11))
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = target.Character.HumanoidRootPart

        -- Desancorar o jogador
        hrp.Anchored = false

        -- Restaurar movimentação
        local humanoid = target.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = 16
            humanoid.JumpPower = 50
        end

        -- Remover o gelo visual
        local ice = target.Character:FindFirstChild("FreezeBlock")
        if ice then
            ice:Destroy()
        end

        warn(target.Name .. " foi descongelado!")
    end
end)

addCommand(";kick all", function()
    for _, p in pairs(Players:GetPlayers()) do
        if not isAdmin(p) then
            p:Kick("Você foi expulso por um administrador.")
        end
    end
end)

addCommand(";pkick ", function(msg, admin)
    -- msg:sub(8) pula o ";pkick "
    local args = msg:sub(8)
    local firstSpace = args:find(" ")

    if not firstSpace then
        warn("Use: ;pkick [player] [razão]")
        return
    end

    local playerName = args:sub(1, firstSpace-1)
    local reason = args:sub(firstSpace+1)

    local target = findPlayerByNameFragment(playerName)

    if target and not isAdmin(target) then
        target:Kick(reason)
        warn(target.Name .. " foi expulso por: " .. reason)
    else
        warn("Jogador não encontrado ou é admin.")
    end
end)

addCommand(";sit all", function()
    for _, p in pairs(Players:GetPlayers()) do
        if p.Character and p.Character:FindFirstChildOfClass("Humanoid") then
            p.Character:FindFirstChildOfClass("Humanoid").Sit = true
        end
    end
end)

addCommand(";kick ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and not isAdmin(target) then
        target:Kick("Você foi expulso por um administrador.")
    end
end)

addCommand(";expusar ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and not isAdmin(target) then
        target:Kick("Você foi expulso por um administrador.")
    end
end)

-- DANÇA (sem precisar ser admin)
addCommand(";dance ", function(msg)
    local target = findPlayerByNameFragment(msg:sub(8))
    if target and target.Character then
        local humanoid = target.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            sendChat("/e dance2") -- só aparece no chat, não força animação real
        end
    end
end)

-- KILL (não mata admin)
addCommand(";kill ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(7))
    if target and not isAdmin(target) and target.Character then
        local humanoid = target.Character:FindFirstChild("Humanoid")
        if humanoid then humanoid.Health = 0 end
    end
end)

-- COMANDO ;ch para fazer o jogador "falar" (apenas admins)
addCommand(";ch ", function(msg, admin)
    if not isAdmin(admin) then return end

    local args = msg:sub(5) -- remove ";ch "
    local firstSpace = args:find(" ")
    if not firstSpace then
        warn("Use: ;ch [player] [mensagem]")
        return
    end

    local targetText = args:sub(1, firstSpace - 1):lower()
    local message = args:sub(firstSpace + 1)

    local Players = game:GetService("Players")
    local targetPlayer = nil

    -- Procura jogador pelo nome ou DisplayName
    for _, p in pairs(Players:GetPlayers()) do
        local nameLower = p.Name:lower()
        local displayNameLower = p.DisplayName:lower()
        if nameLower:sub(1, #targetText) == targetText or displayNameLower:sub(1, #targetText) == targetText then
            targetPlayer = p
            break
        end
    end

    if targetPlayer then
        -- Função que envia a mensagem no chat como se o jogador tivesse falado
        sendChat(message, targetPlayer)
        print(targetPlayer.Name .. " disse: " .. message)
    else
        warn("Jogador não encontrado: " .. targetText)
    end
end)

addCommand(";sit ", function(msg, admin)
    local targetName = msg:sub(6):lower()
    
    for _, p in pairs(Players:GetPlayers()) do
        if (p.Name:lower():find(targetName) or p.DisplayName:lower():find(targetName)) and not isAdmin(p) then
            local humanoid = p.Character and p.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.Sit = true
            end
        end
    end
end)

-- FLING
addCommand(";fling ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(8))
    if target and not isAdmin(target) and target.Character then
        local hrp = target.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            local bv = Instance.new("BodyVelocity")
            bv.Velocity = Vector3.new(100, 100, 100) -- força
            bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
            bv.Parent = hrp
            game:GetService("Debris"):AddItem(bv, 0.5)
        end
    end
end)

addCommand(";f ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(8))
    if target and not isAdmin(target) and target.Character then
        local hrp = target.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            local bv = Instance.new("BodyVelocity")
            bv.Velocity = Vector3.new(100, 100, 100) -- força
            bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
            bv.Parent = hrp
            game:GetService("Debris"):AddItem(bv, 0.5)
        end
    end
end)

addCommand(";show", function()
    sendChat("✅️ here.")
end)


addCommand("-a", function()
    sendChat("#")
end)

addCommand(";dance all", function()
    sendChat("/e dance2")
end)


-- REJOIN COMMAND
addCommand(";rejoin ", function(msg, admin)
    local target = findPlayerByNameFragment(msg:sub(9))
    if target then
        if target == Players.LocalPlayer then
            -- Rejoin pro próprio admin
            local TeleportService = game:GetService("TeleportService")
            TeleportService:Teleport(game.PlaceId, target)
        else
            target:Kick("Reentre no jogo! (Comando ;rejoin)")
        end
    end
end)

addCommand(";painel", function(msg, admin, root)
    if not isAdmin(admin) then return end
    
    -- 🔹 Aqui vai o script que só o admin vê/roda
    print("Executando painel só para:", admin.Name)


    local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title = "admin-cmds | 1.0 v2",
    Icon = "shield",
    Author = "ghost and Oriveira Dev",
    Folder = "admfloher",
    Size = UDim2.fromOffset(440, 360),
    Transparent = true,
    Theme = "Dark",
    SideBarWidth = 190,
    Background = "",
    BackgroundImageTransparency = 0.42,
    HideSearchBar = true,
    ScrollBarEnabled = true,
    User = {
        Enabled = true,
        Anonymous = false,
        Callback = function()
            print("clicked")
        end,
    },
})

local MainSection = Window:Section({
    Title = "Cmds : Player",
    Icon = "package"
})


local Tab = MainSection:Tab({
    Title = "All",
    Icon = "info",
    Opened = true
})

local Section = Tab:Section({ 
    Title = "cmds All",
    TextXAlignment = "Left",
    TextSize = 15,
})

-- BotÃµes de comandos em massa
local comandosAll = {
    {Titulo = "Bring All", Comando = "bring all"},
    {Titulo = "Kill All", Comando = "kill all"},
    {Titulo = "Kick All", Comando = "kick all"},
    {Titulo = "Sit All", Comando = "sit all"},
    {Titulo = "Lag All", Comando = "lag all"},
    {Titulo = "Dance All", Comando = "dance all"},
}

for _, data in ipairs(comandosAll) do
    Tab:Button({
        Title = data.Titulo,
        Desc = "Executa: ;" .. data.Comando,
        Locked = false,
        Callback = function()
            local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
            if chat then
                chat:SendAsync(";" .. data.Comando)
            end
        end
    })
end


local Section = Tab:Section({ 
    Title = "< News Cmds In SOON!",
    TextXAlignment = "Left",
    TextSize = 15,
})


local Tab = MainSection:Tab({
    Title = "Players",
    Icon = "menu",
    Opened = true
})


local Section = Tab:Section({ 
    Title = "< Moderation",
    TextXAlignment = "Left",
    TextSize = 15,
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Variável para armazenar o Player alvo
local jogadorAlvo = nil
local viewAtivo = false
local loopView = nil

-- Busca por nome/displayname parcial
local function buscarJogador(nome)
    nome = nome:lower()
    for _, p in ipairs(Players:GetPlayers()) do
        if p.Name:lower():sub(1, #nome) == nome or p.DisplayName:lower():sub(1, #nome) == nome then
            return p
        end
    end
end

-- Input para selecionar jogador
Tab:Input({
    Title = "Selecionar Alvo",
    Desc = "Digite nome ou apelido do jogador",
    Placeholder = "Ex: zMario",
    InputIcon = "user",
    Type = "Input",
    Callback = function(txt)
        local achado = buscarJogador(txt)
        if achado then
            jogadorAlvo = achado -- guarda o Player, não só o nome
            warn("Alvo selecionado: " .. jogadorAlvo.Name)
        else
            jogadorAlvo = nil
            warn("Jogador não encontrado")
        end
    end
})

local Button = Tab:Button({
    Title = "Teleportar",
    Desc = "Teleporta até o jogador selecionado",
    Locked = false,
    Callback = function()
        if jogadorAlvo and jogadorAlvo.Character and jogadorAlvo.Character:FindFirstChild("HumanoidRootPart") then
            local myChar = LocalPlayer.Character
            if myChar and myChar:FindFirstChild("HumanoidRootPart") then
                myChar:MoveTo(jogadorAlvo.Character.HumanoidRootPart.Position + Vector3.new(0, 3, 0))
                warn("Teleportado até: " .. jogadorAlvo.Name)
            end
        else
            warn("Nenhum alvo válido selecionado!")
        end
    end
})

-- Função para ativar/desativar view
local function setView(state)
    viewAtivo = state
    if not state then
        -- Desliga e reseta
        if loopView then
            loopView:Disconnect()
            loopView = nil
        end
        Camera.CameraSubject = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
        Camera.CameraType = Enum.CameraType.Custom
    else
        -- Loop para manter a view no alvo
        loopView = game:GetService("RunService").RenderStepped:Connect(function()
            if jogadorAlvo and jogadorAlvo.Character and jogadorAlvo.Character:FindFirstChild("Humanoid") then
                Camera.CameraSubject = jogadorAlvo.Character.Humanoid
            end
        end)
    end
end

-- Toggle na sua UI
local Toggle = Tab:Toggle({
    Title = "View",
    Desc = "Espectar outro player",
    Icon = "eye",
    Type = "Checkbox",
    Default = false,
    Callback = function(state) 
        setView(state)
        print("View -> " .. tostring(state))
    end
})

-- Comandos direcionados ao jogador selecionado
local Section = Tab:Section({
    Title = "< Comandos TROLL >",
    TextXAlignment = "Left",
    TextSize = 15,
})

Tab:Button({
    Title = "Show : usuarios",
    Desc = "Verificar si ha um player user fala here",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(";show") end
    end
})

Tab:Button({
    Title = "Show disfarÃ§ado",
    Desc = "Verificar#",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(".") end
    end
})

local Section = Tab:Section({
    Title = "< cmds >",
    TextXAlignment = "Left",
    TextSize = 15,
})

local comandosAlvo = {"kill", "bring", "fling", "crash", "dance", "maid", "freeze", "unfreeze", "jail", "unjail", "sit", "kick", "lag"}

for _, cmd in ipairs(comandosAlvo) do
    Tab:Button({
        Title = cmd,
        Desc = "usar ;" .. cmd .. " NOME",
        Locked = false,
        Callback = function()
            if jogadorAlvo then
                local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
                if chat then
                    -- usa o Name do Player
                    chat:SendAsync(";" .. cmd .. " " .. jogadorAlvo.Name)
                end
            else
                warn("Nenhum jogador selecionado!")
            end
        end
    })
end

Tab:Button({
    Title = "Show users | melhor",
    Desc = "ele adiciona tag em todos os usuarios Do Script",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(";verifique") end
    end
})

Tab:Button({
    Title = "Horror : usuarios",
    Desc = "e tipo troll ele bota uma luz red em tu e daisy Music toca quem toca em tu leva kick",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(";horror") end
    end
})


Tab:Button({
    Title = "MUNDO",
    Desc = "[NEW] REFERENCE JOJO range",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(";MUNDO") end
    end
})

Tab:Button({
    Title = "domain expansion",
    Desc = "[NEW] REFERENCE Jujutiso Kaisen renge",
    Locked = false,
    Callback = function()
        local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
        if chat then chat:SendAsync(";domain expansion") end
    end
})

local Tab = MainSection:Tab({
    Title = "Say ",
    Icon = "message-circle",
    Opened = true
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Variáveis globais
local jogadorAlvo = nil
local textoDigitado = ""

-- Função para buscar jogador parcial
local function buscarJogador(nome)
    nome = nome:lower()
    for _, p in ipairs(Players:GetPlayers()) do
        if p.Name:lower():sub(1, #nome) == nome or p.DisplayName:lower():sub(1, #nome) == nome then
            return p
        end
    end
end

-- Input para selecionar alvo
Tab:Input({
    Title = "Selecionar Alvo",
    Desc = "Digite nome ou apelido do jogador",
    Placeholder = "Ex: zMario",
    InputIcon = "user",
    Type = "Input",
    Callback = function(txt)
        local achado = buscarJogador(txt)
        if achado then
            jogadorAlvo = achado
            warn("Alvo selecionado: " .. jogadorAlvo.Name)
        else
            jogadorAlvo = nil
            warn("Jogador não encontrado")
        end
    end
})

-- Input para mensagem
Tab:Input({
    Title = "Mensagem",
    Desc = "Digite algo para enviar",
    Placeholder = "Ex: Olá!",
    InputIcon = "message-square",
    Type = "Input",
    Callback = function(txt)
        textoDigitado = txt
    end
})

-- Botão para enviar
Tab:Button({
    Title = "Enviar Mensagem",
    Desc = "Fala como ;ch [alvo] [mensagem]",
    Locked = false,
    Callback = function()
        if jogadorAlvo and textoDigitado ~= "" then
            local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
            if chat then
                chat:SendAsync(";ch " .. jogadorAlvo.Name .. " " .. textoDigitado)
            end
        else
            warn("Selecione um alvo e digite uma mensagem antes de enviar.")
        end
    end
})

local Section = Tab:Section({ 
    Title = ";ms :Mensagem todos",
    TextXAlignment = "Left",
    TextSize = 15,
})


local textoDigitado = ""

Tab:Input({
    Title = "Mensagem",
    Desc = "Digite algo para enviar",
    Placeholder = "Texto ms que sera enviado...",
    InputIcon = "message-square",
    Type = "Input",
    Callback = function(txt)
        textoDigitado = txt
    end
})

Tab:Button({
    Title = "Enviar Mensagem",
    Desc = "mensagem Ms",
    Locked = false,
    Callback = function()
        if textoDigitado ~= "" then
            local chat = game:GetService("TextChatService").TextChannels:FindFirstChild("RBXGeneral")
            if chat then
                chat:SendAsync(";ms " .. textoDigitado)
            end
        else
            warn("Digite algo para falar.")
        end
    end
})





local Tab = MainSection:Tab({
    Title = "Job-Id",
    Icon = "user",
    Opened = true
})


local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")

local jobIdInput = ""

Tab:Input({
    Title = "JobId",
    Desc = "Digite o JobId para teleportar",
    Placeholder = "Ex: abc123-def456",
    InputIcon = "hash",
    Type = "Input",
    Callback = function(txt)
        jobIdInput = txt
    end
})

Tab:Button({
    Title = "Teleportar",
    Desc = "Executa o teleport para o JobId informado",
    Locked = false,
    Callback = function()
        local rawInput = jobIdInput or ""
        rawInput = string.gsub(rawInput, "[`ðŸ“Ž]", "")
        rawInput = string.gsub(rawInput, "JobId:?%s*", "")
        rawInput = string.gsub(rawInput, "[^%w%-]", "") -- mantÃ©m sÃ³ letras, nÃºmeros e hÃ­fen

        if rawInput == "" then
            warn("JobId invÃ¡lido ou vazio!")
            return
        end

        local PlaceId = game.PlaceId

        TeleportService:TeleportToPlaceInstance(PlaceId, rawInput, Players.LocalPlayer)
    end,
})


local MainSection = Window:Section({
    Title = "Infos",
    Icon = "door-open"
})

local Tab = MainSection:Tab({
    Title = "Creditos",
    Icon = "info",
    Opened = true
})

local Section = Tab:Section({ 
    Title = "Feito por Ghost e oriveiraDev",
    TextXAlignment = "Left",
    TextSize = 15,
})

local Section = Tab:Section({ 
    Title = "intuito :  e zoeira e diversão! n vai Zomba em",
    TextXAlignment = "Left",
    TextSize = 15,
})

local Section = Tab:Section({ 
    Title = "Havens script foi feito pra ajudar os users!!",
    TextXAlignment = "Left",
    TextSize = 15,
})

local Section = Tab:Section({ 
    Title = "ghost 2022 | epoca boa | vlw por ler",
    TextXAlignment = "Left",
    TextSize = 15,
})


-- Fundo
Window:SetBackgroundImage("rbxassetid://8")
Window:SetBackgroundImageTransparency(0.2)
    
end)
